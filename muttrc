# Source account hooks with authorization data 
# we put some hooks with our credentials in here for each account.  They need to look like this:
# account-hook imaps://USER@SERVER 'set imap_user=USER imap_pass=PASSWORD smtp_pass=PASSWORD'
# See http://pthree.org/2012/01/07/encrypted-mutt-imap-smtp-passwords/ for more on encrypting this.
# If you choose not to encrypt it, then maybe:
# source ~/.mutt/auth.hooks

source ~/.mutt/auth.hooks

# Make Google SMTP work with Yosemite
set smtp_authenticators = 'gssapi:login'

# Start off with a given profile: Uncomment this to start with a specific 
# profile, or set an alias to pick your preferred profile at startup, e.g.
# alias mutt = "mutt -e 'source ~/.mutt/profile.puppet'
#source ~/.mutt/puppet.profile
source ~/.mutt/personal.profile

# Source our macros, scores
source ~/.mutt/macros
source ~/.mutt/scores
source ~/.mutt/dracula.mutt

# aliases
set alias_file=~/.mutt/aliases
source ~/.mutt/aliases

# Caching and such
set message_cachedir='~/.mutt/cache/bodies'
set header_cache = "~/.mutt/cache/headers"
set certificate_file='~/.mutt/certificates'

# I don't want to be prompted to press keys after piping messages
set wait_key=no

# Misc stuff I ate off the sidewalk that has not made me sick so far
set allow_ansi=yes
set text_flowed=yes
set use_from=yes
set envelope_from=yes
set delete=yes
set wrap=80

# Who is me?
alternates  "mph@puddingbowl.org|mike.hall@puppet.com|pdxmph@gmail.com|mike@bothpieces.com|m@pdbl.org|michael.hall@puppetlabs.com"

# Make stuff show the way we want when viewing a message ...

set markers=no
set smart_wrap

# Fix up the headers we see
ignore *
unignore list-unsubscribe date: from subject To
hdr_order To List-Unsubscribe Date: From Subject 

# Index View Options ---------------------------------
set date_format = "%m/%d"
set index_format = "[%Z] [%2N]  %D  %-20.20F  %s"
set sort = threads                         # like gmail
set sort_aux = reverse-last-date-received  # like gmail
set uncollapse_jump                        # don't collapse on an unread message
set sort_re                                # thread based on regex
set reply_regexp = "^(([Rr][Ee]?(\[[0-9]+\])?: *)?(\[[^]]+\] *)?)*"

# Customize reply attribution

set attribution = "On %{%A, %B %e, %Y}, %n <%a> wrote:\n"

# Some editing options
set edit_headers = no
set autoedit

# There is only one editor 
set editor = "/usr/local/bin/emacsclient  -t -nw"

set query_command = "lbdbq %s 2>/dev/null"

# we'll use goobook, since it has all my contacts.
# pip install goobook, then configure the netrc per https://pypi.python.org/pypi/goobook/1.6
#set query_command="/usr/local/bin/goobook query '%s'"
bind editor <Tab> complete-query
bind editor ^T    complete

# Pager View Options ---------------------------------
set pager_index_lines = 10 # number of index lines to show
set pager_context = 3      # number of context lines to show
set pager_stop             # don't go to next message automatically
set menu_scroll            # scroll in menus
unset markers              # no ugly plus signs

alternative_order text/plain text/enriched text/html

bind index gg       first-entry
bind index G        last-entry
bind index R        group-reply
bind index <tab>    sync-mailbox
bind index <space>  collapse-thread

# Ctrl-R to mark all as read
macro index \Cr "T~U<enter><tag-prefix><clear-flag>N<untag-pattern>.<enter>" "mark all messages as read"

# Sidebar Patch --------------------------------------
#set sidebar_delim   = '  │'
set sidebar_visible = no
set sidebar_width   = 30
color sidebar_new color221 color233
# Status Bar -----------------------------------------
set status_chars  = " *%A"
set status_format = "───[ Folder: %f ]───[%r%m messages%?n? (%n new)?%?d? (%d to delete)?%?t? (%t tagged)? ]───%>─%?p?( %p postponed )?───"
# Sidebar Navigation ---------------------------------
bind index,pager <right>  sidebar-open
bind index,pager B sidebar-toggle-visible
bind index,pager > sidebar-next
bind index,pager < sidebar-prev